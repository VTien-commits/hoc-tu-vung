<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4A90E2">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="images/icon-192.png">
    <title>H·ªçc t·ª´ v·ª±ng</title>
    <!-- (M·ªöI) Th√™m th∆∞ vi·ªán SheetJS (xlsx) ƒë·ªÉ xu·∫•t Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

    <!-- M√†n h√¨nh 1: Ch·ªçn Ch·∫ø ƒë·ªô ch∆°i -->
    <div id="mode-selection-overlay" class="mode-overlay">
        <div class="mode-selection-box">
            <h2>Ch·∫ø ƒë·ªô h·ªçc t·ª´ v·ª±ng</h2>
            <!-- (ƒê√É X√ìA) X√≥a tr·∫°ng th√°i t·∫£i -->
            <!-- <p id="loading-status" class="loading-status">ƒêang t·∫£i d·ªØ li·ªáu...</p> -->

            <button id="mode-audio-button" class="mode-select-button" disabled>
                <span>üîä</span>
                Nghe & N·ªëi
                <p>Nghe √¢m thanh v√† n·ªëi v·ªõi nghƒ©a ti·∫øng Vi·ªát.</p>
            </button>
            <button id="mode-text-button" class="mode-select-button" disabled>
                <span>üìñ</span>
                ƒê·ªçc & N·ªëi
                <p>ƒê·ªçc t·ª´ ti·∫øng Anh (k√®m phi√™n √¢m) v√† n·ªëi v·ªõi nghƒ©a.</p>
            </button>

            <button id="settings-button" class="action-button secondary-button">C√†i ƒë·∫∑t ‚öôÔ∏è</button>
            <button id="reload-button" class="action-button secondary-button">T·∫£i l·∫°i ·ª®ng d·ª•ng</button>
        </div>
    </div>

    <!-- M√†n h√¨nh 2: Ch·ªçn Ch·ªß ƒë·ªÅ -->
    <div id="topic-selection-overlay" class="mode-overlay" style="display: none;">
        <div class="mode-selection-box">
            <h2>Ch·ªçn ch·ªß ƒë·ªÅ</h2>
            <div id="topic-list" class="topic-list-container">
                <!-- C√°c n√∫t ch·ªß ƒë·ªÅ s·∫Ω ƒë∆∞·ª£c JS ch√®n v√†o ƒë√¢y -->
            </div>
            <button id="topic-back-button" class="action-button secondary-button">Quay l·∫°i</button>
        </div>
    </div>

    <!-- M√†n h√¨nh 3: Giao di·ªán game ch√≠nh -->
    <header style="display: none;">
        <button id="home-button" class="header-button" title="V·ªÅ trang ch·ªß">üè†</button>
        <h1 id="game-title">ƒêang t·∫£i...</h1>
        <!-- (ƒê√É X√ìA) N√∫t l∆∞u ƒë√£ b·ªã x√≥a -->
        <div class="header-button-placeholder"></div>

        <div class="score-container">
            <span>ƒêi·ªÉm</span>
            <span id="score">0</span>
        </div>
    </header>

    <main class="main-container" style="display: none;">
        <div class="progress-bar-container">
            <div id="progress-bar"></div>
        </div>
        <div id="game-container" class="game-container">
            <div id="left-column" class="column"></div>
            <div id="right-column" class="column"></div>
        </div>

        <!-- (C·∫¨P NH·∫¨T) H√†ng ch·ª©a N√∫t Next v√† Timer - ƒê√£ ho√°n ƒë·ªïi v·ªã tr√≠ -->
        <div class="game-controls">
            <div id="timer" class="timer-display">01:00</div>
            <button id="next-round-button" class="action-button" style="display: none;">Next</button>
        </div>
    </main>

    <!-- (C·∫¨P NH·∫¨T) Modal C√†i ƒë·∫∑t (S·∫Øp x·∫øp l·∫°i) -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>C√†i ƒë·∫∑t</h2>

            <button id="stats-button" class="action-button">Th·ªëng k√™ T·ª´ v·ª±ng</button>
            
            <label for="timer-setting" class="settings-label">Th·ªùi gian ƒë·∫øm ng∆∞·ª£c (gi√¢y):</label>
            <!-- (C·∫¨P NH·∫¨T) ƒê·ªïi type="number" th√†nh type="tel" ƒë·ªÉ c√≥ b√†n ph√≠m s·ªë ƒë∆°n gi·∫£n -->
            <input type="tel" id="timer-setting" class="settings-input" value="60">

            <button id="export-excel-button" class="action-button">Xu·∫•t d·ªØ li·ªáu (Excel)</button>
            
            <button id="load-online-button" class="action-button">Load Data Online</button>
            <p id="load-online-status" class="modal-status" style="display: none;"></p>

            <button id="clear-cache-button" class="action-button secondary-button">X√≥a Cache Audio</button>
            <button id="reset-progress-button" class="action-button modal-close-button">H·ªçc l·∫°i t·ª´ ƒë·∫ßu</button>
            <button id="settings-close-button" class="action-button secondary-button">ƒê√≥ng</button>
        </div>
    </div>

    <!-- (C·∫¨P NH·∫¨T) Modal Th·ªëng k√™ (Th√™m filter) -->
    <div id="stats-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content large">
            <h2>Th·ªëng k√™ T·ª´ v·ª±ng</h2>

            <!-- (M·ªöI) H√†ng Filter v√† T·ªïng s·ªë -->
            <div class="stats-header">
                <select id="stats-topic-filter" class="settings-input">
                    <!-- JS s·∫Ω ch√®n c√°c ch·ªß ƒë·ªÅ v√†o ƒë√¢y -->
                </select>
                <span id="stats-total-count">T·ªïng s·ªë t·ª´: 0</span>
            </div>

            <div id="stats-list" class="stats-list-container">
                <!-- Th·ªëng k√™ s·∫Ω ƒë∆∞·ª£c JS ch√®n v√†o ƒë√¢y -->
            </div>
            <button id="stats-close-button" class="action-button modal-close-button">ƒê√≥ng</button>
        </div>
    </div>

    <!-- (M·ªöI) Modal X√°c nh·∫≠n H·ªçc l·∫°i t·ª´ ƒë·∫ßu -->
    <div id="confirm-reset-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>X√°c nh·∫≠n</h2>
            <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô ti·∫øn ƒë·ªô v√† h·ªçc l·∫°i t·ª´ ƒë·∫ßu kh√¥ng?</p>
            <button id="confirm-reset-confirm" class="action-button modal-close-button">X√°c nh·∫≠n X√≥a</button>
            <button id="confirm-reset-cancel" class="action-button secondary-button">H·ªßy</button>
        </div>
    </div>

    <!-- (M·ªöI) Modal X√°c nh·∫≠n X√≥a Cache Audio -->
    <div id="confirm-cache-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>X√°c nh·∫≠n</h2>
            <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a cache audio kh√¥ng? (C√°c file √¢m thanh s·∫Ω ph·∫£i t·∫£i l·∫°i)</p>
            <button id="confirm-cache-confirm" class="action-button modal-close-button">X√°c nh·∫≠n X√≥a</button>
            <button id="confirm-cache-cancel" class="action-button secondary-button">H·ªßy</button>
        </div>
    </div>

    <!-- Loader (Chung) -->
    <div id="loader" class="loader-overlay" style="display: none;">
        <div class="loader-content">
            <div class="spinner"></div>
            <p id="loader-text">ƒêang t·∫£i...</p>
        </div>
    </div>
</body>
<script src="main.js"></script>
</html>